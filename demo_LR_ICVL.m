load('.\CRF_database\NIKON_D700.mat');   % crf
addpath('.\SupResPALM\include');

% indoor = {'lst_0408-0950.mat', 'lst_0408-1004.mat', 'lst_0408-1012.mat'};
% rural = {'eve_0331-1647.mat', 'eve_0331-1656.mat', 'eve_0331-1657.mat', ...
%          'eve_0331-1705.mat', 'rsh_0406-1413.mat'};
% park = {'omer_0331-1055.mat', 'omer_0331-1102.mat', 'omer_0331-1104.mat', ...
%         'omer_0331-1135.mat', 'omer_0331-1159.mat', 'prk_0328-1025.mat', ...
%         'prk_0328-1031.mat', 'prk_0328-1034.mat', 'prk_0328-1045.mat'};
%     
% plant = {'plt_0411-1116.mat', 'plt_0411-1155.mat', 'plt_0411-1207.mat', ...
%          'plt_0411-1211.mat', 'plt_0411-1232-1.mat'};

full_test = {'4cam_0411-1640-1.mat', ...
             '4cam_0411-1648.mat', ...
             'BGU_0403-1419-1.mat', ...
             'BGU_0522-1113-1.mat', ...
             'BGU_0522-1127.mat', ...
             'BGU_0522-1136.mat', ...
             'BGU_0522-1201.mat', ...
             'BGU_0522-1203.mat', ...
             'BGU_0522-1211.mat', ...
             'BGU_0522-1216.mat', ...
             'BGU_0522-1217.mat', ...
             'Flower_0325-1336.mat', ...
             'Master20150112_f2_colorchecker.mat', ...
             'Maz0326-1038.mat', ...
             'Ramot0325-1364.mat', ...
             'bguCAMP_0514-1659.mat', ...
             'bguCAMP_0514-1711.mat', ...
             'bguCAMP_0514-1712.mat', ...
             'bguCAMP_0514-1718.mat', ...
             'bguCAMP_0514-1723.mat', ...
             'bguCAMP_0514-1724.mat', ...
             'bgu_0403-1439.mat', ...
             'bgu_0403-1444.mat', ...
             'bgu_0403-1459.mat', ...
             'bgu_0403-1511.mat', ...
             'bgu_0403-1523.mat', ...
             'bgu_0403-1525.mat', ...
             'eve_0331-1549.mat', ...
             'eve_0331-1551.mat', ...
             'eve_0331-1601.mat', ...
             'eve_0331-1602.mat', ...
             'eve_0331-1606.mat', ...
             'eve_0331-1618.mat', ...
             'eve_0331-1632.mat', ...
             'eve_0331-1633.mat', ...
             'eve_0331-1646.mat', ...
             'eve_0331-1647.mat', ...
             'eve_0331-1656.mat', ...
             'eve_0331-1657.mat', ...
             'eve_0331-1702.mat', ...
             'eve_0331-1705.mat', ...
             'grf_0328-0949.mat', ...
             'hill_0325-1219.mat', ...
             'hill_0325-1228.mat', ...
             'hill_0325-1235.mat', ...
             'hill_0325-1242.mat', ...
             'lst_0408-0950.mat', ...
             'lst_0408-1004.mat', ...
             'lst_0408-1012.mat', ...
             'maz_0326-1048.mat', ...
             'mor_0328-1209-2.mat', ...
             'omer_0331-1055.mat', ...
             'omer_0331-1102.mat', ...
             'omer_0331-1104.mat', ...
             'omer_0331-1118.mat', ...
             'omer_0331-1119.mat', ...
             'omer_0331-1130.mat', ...
             'omer_0331-1131.mat', ...
             'omer_0331-1135.mat', ...
             'omer_0331-1150.mat', ...
             'omer_0331-1159.mat', ...
             'pepper_0503-1228.mat', ...
             'pepper_0503-1229.mat', ...
             'pepper_0503-1236.mat', ...
             'peppers_0503-1308.mat', ...
             'peppers_0503-1311.mat', ...
             'peppers_0503-1315.mat', ...
             'peppers_0503-1330.mat', ...
             'peppers_0503-1332.mat', ...
             'plt_0411-1037.mat', ...
             'plt_0411-1046.mat', ...
             'plt_0411-1116.mat', ...
             'plt_0411-1155.mat', ...
             'plt_0411-1200-1.mat', ...
             'plt_0411-1207.mat', ...
             'plt_0411-1210.mat', ...
             'plt_0411-1211.mat', ...
             'plt_0411-1232-1.mat', ...
             'prk_0328-0945.mat', ...
             'prk_0328-1025.mat', ...
             'prk_0328-1031.mat', ...
             'prk_0328-1034.mat', ...
             'prk_0328-1037.mat', ...
             'prk_0328-1045.mat', ...
             'ramot_0325-1322.mat', ...
             'rsh2_0406-1505.mat', ...
             'rsh_0406-1343.mat', ...
             'rsh_0406-1356.mat', ...
             'rsh_0406-1413.mat', ...
             'rsh_0406-1427.mat', ...
             'rsh_0406-1441-1.mat', ...
             'rsh_0406-1443.mat', ...
             'sami_0331-1019.mat', ...
             'sat_0406-1107.mat', ...
             'sat_0406-1129.mat', ...
             'sat_0406-1130.mat', ...
             'sat_0406-1157-1.mat', ...
             'strt_0331-1027.mat'};


RMSE = zeros(1,size(full_test, 2));
SAM = zeros(1,size(full_test, 2));
time = zeros(1,size(full_test, 2));

for i = 1:size(full_test,2)
    load(strcat('..\data\HSI_ICVL\', full_test{i}));
    
    rad = rad(1:1024,1:1024,:);
    rad = hyperConvert2d(rad);
    rad = rad ./ max(rad(:));
    [D_rad, RGB_rad] = hyperSynthetic(rad, crf, 32);

    D_rad = hyperConvert3d(D_rad);
    RGB_rad = hyperConvert3d(RGB_rad);
   
    tic;
    hyper = LR_latest32(D_rad, RGB_rad); %%%%%%
    time(i) = toc;
    hyper(hyper > 1) = 1;
    hyper(hyper < 0) = 0;

    hyper = round(hyper * 255);
    rad = round(rad * 255);

    RMSE(i) = hyperErrRMSE(rad, hyper);
    SAM(i) = hyperErrSam(rad, hyper);
    fprintf(full_test{i});
    fprintf('  %f  %f  %f\n', RMSE(i), SAM(i), time(i));

end

fprintf('aver RMSE %f\n aver SAM %f\n, aver time %f\n', mean(RMSE), mean(SAM), mean(time));